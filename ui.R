source(file = "global.R")
############# UI

navbarPage("PQ Text Analysis",
           footer = column(12, helpText(
               "We would love your feedback on our tool! To complete a quick survey please click",
               a(href="https://www.surveymonkey.co.uk/r/FV9PCT2", target="_blank", "here")
             )
             ),
  tabPanel("Similarity",
    fluidRow(
      column(6,
        textInput(inputId = "question",
                  label = "Search Text",
                  width = "100%",
                  value = "Enter search text here"
                  )
            ),

      column(3,
             conditionalPanel(
               condition = "input.question.length > 0",
               sliderInput(inputId = "q_date_range",
                           label = "Question Date Range",
                           min = min(rawData$Date) - 1,
                           max = max(rawData$Date) + 1,
                           value = c(min(rawData$Date), max(rawData$Date)),
                           step = 1
                           )
               )
             )

      #column(3,
      #      sliderInput(inputId = "a_date_range",
      #                  label = "Answer Date Range",
      #                  min = min(rawData$Date) - 1,
      #                  value = c(min(rawData$Date), max(rawData$Date)),
      #                  max = max(rawData$Date) + 1,
      #                  step = 1
      #                  )
      #      )
      ),
    fluidRow(
      column(6,
             conditionalPanel(
               condition = "input.question.length > 0",
               dataTableOutput("similarity_table")
               )
             ),
      column(6,
             conditionalPanel(
               condition = "input.question.length > 0",
               plotlyOutput("similarity_plot", height = 500)
               )
             ),
    fluidRow(
      column(12,
      conditionalPanel(
      condition =
        "typeof(input.similarity_table_rows_selected) != 'undefined' && input.similarity_table_rows_selected.length > 0",
      dataTableOutput("q_text_table")
      ))
    ))),
  tabPanel("Topic Analysis",
           fluidRow(column(3,
             selectizeInput(inputId = "cluster_choice",
             label = "Choose Topic Number:",
             choices = unique(data$Cluster)
             )),
             column(9,
                    conditionalPanel(
                      condition = "input.cluster_choice.length > 0",
                      plotOutput("wordcloud")
                      ))
             ),
           fluidRow(
             conditionalPanel(
               condition = "input.cluster_choice.length > 0",
               plotOutput("cluster_choice")
               )
             ),
             fluidRow(
               conditionalPanel(
                 condition = "input.cluster_choice.length > 0",
                 dataTableOutput("cluster_documents")
                 )
               )
           ),
  tabPanel("Q&A Analysis",
           sidebarPanel(
             wellPanel(radioButtons(inputId = "q_analysis",
                                    label = "Choose a House",
                                    choices = c("Lords", "Commons"),
                                    inline = TRUE)
             ),
             wellPanel(
               uiOutput("q_analysis_ui")
             )
           ),
           mainPanel(
             plotOutput("q_analysis_plot"),
             dataTableOutput("q_analysis_table")
           )
  ),
  tabPanel("Data",
           dataTableOutput("data_pane")
  ))
